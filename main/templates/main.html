{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Dashboard for monitoring devices" />
  <meta name="author" content="Ayapov Yerlan" />
  <meta name="keywords" content="dashboard, monitoring, devices, iot" />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="icon" href="{% static 'main/images/favicon.ico' %}" type="image/x-icon" />
  <link rel="apple-touch-icon" href="{% static 'main/images/su-logo.png' %}" />

  <!-- СНАЧАЛА Bootstrap, ПОТОМ ваш CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="{% static 'main/styles/main.css' %}" />

  <title>{% block title %}Dashboard{% endblock %}</title>
</head>
<body>
  <!-- Мобильный верхний navbar -->
  <nav class="navbar bg-light fixed-top d-md-none mobile-navbar px-2">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center gap-2" href="{% url 'dashboard' %}">
        <img src="{% static 'main/images/logo.png' %}" alt="Logo" style="height:28px">
        <span>Мониторинг</span>
      </a>
      <button class="navbar-toggler" type="button"
              data-bs-toggle="offcanvas" data-bs-target="#mobileMenu"
              aria-controls="mobileMenu" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>

  <!-- Offcanvas меню (моб.) -->
  <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="mobileMenu" aria-labelledby="mobileMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="mobileMenuLabel">Меню</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Закрыть"></button>
    </div>
    <div class="offcanvas-body d-flex flex-column">
            <ul class="nav flex-column">
        <li class="nav-item {% if active == 'dashboard' %}active{% endif %}">
          <a class="nav-link {% if active == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
            <span class="flex-grow-1">Мониторинг</span>
            <i class="fa-solid fa-chart-line ms-2"></i>
          </a>
        </li>
        <li class="nav-item {% if active == 'profile' %}active{% endif %}">
          <a class="nav-link {% if active == 'profile' %}active{% endif %}" href="{% url 'profile' %}">
            <span class="flex-grow-1">Профиль</span>
            <i class="fa-solid fa-user ms-2"></i>
          </a>
        </li>
        <li class="nav-item {% if active == 'training' %}active{% endif %}">
          <a class="nav-link {% if active == 'training' %}active{% endif %}" href="{% url 'training' %}">
            <span class="flex-grow-1">Обучение</span>
            <i class="fa-solid fa-brain ms-2"></i>
          </a>
        </li>
        <li class="nav-item {% if active == 'control' %}active{% endif %}">
          <a class="nav-link {% if active == 'control' %}active{% endif %}" href="{% url 'device_control' %}">
            <span class="flex-grow-1">Управление</span>
            <i class="fa-solid fa-robot ms-2"></i>
          </a>
        </li>
        <li class="nav-item"><a class="nav-link disabled" href="#"><span class="flex-grow-1">Сеть</span><i class="fa-solid fa-globe ms-2"></i></a></li>
        <li class="nav-item"><a class="nav-link" href="#"><span class="flex-grow-1">Настройки</span><i class="fa-solid fa-cogs ms-2"></i></a></li>
        <li class="nav-item"><a class="nav-link" href="#"><span class="flex-grow-1">Сервис</span><i class="fa-solid fa-cog ms-2"></i></a></li>
        <li class="nav-item"><a class="nav-link" href="#"><span class="flex-grow-1">Помощь</span><i class="fa-solid fa-question-circle ms-2"></i></a></li>
      </ul>
      <div class="mt-auto">
        <img src="{% static 'main/images/su-logo-text.png' %}" alt="Secondary Logo" class="img-fluid">
      </div>
    </div>
  </div>

  <!-- Фиксированный сайдбар (десктоп) -->
  <nav class="d-none d-md-flex sidebar sidebar-fixed flex-column">
    <h5 class="text-center p-3">
      <img src="{% static 'main/images/logo.png' %}" alt="Logo" class="img-fluid"/>
    </h5>

        <ul class="nav flex-column px-3 gap-1">
      <li class="nav-item {% if active == 'dashboard' %}active{% endif %}">
        <a class="nav-link {% if active == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
          <span class="flex-grow-1">Мониторинг</span>
          <i class="fa-solid fa-chart-line ms-2"></i>
        </a>
      </li>
      <li class="nav-item {% if active == 'profile' %}active{% endif %}">
        <a class="nav-link {% if active == 'profile' %}active{% endif %}" href="{% url 'profile' %}">
          <span class="flex-grow-1">Профиль</span>
          <i class="fa-solid fa-user"></i>
        </a>
      </li>
      <li class="nav-item {% if active == 'training' %}active{% endif %}">
        <a class="nav-link {% if active == 'training' %}active{% endif %}" href="{% url 'training' %}">
          <span class="flex-grow-1">Обучение</span>
          <i class="fa-solid fa-brain"></i>
        </a>
      </li>
      <li class="nav-item {% if active == 'control' %}active{% endif %}">
        <a class="nav-link {% if active == 'control' %}active{% endif %}" href="{% url 'device_control' %}">
          <span class="flex-grow-1">Управление</span>
          <i class="fa-solid fa-robot"></i>
        </a>
      </li>
      <li class="nav-item"><a class="nav-link disabled" href="#"><span class="flex-grow-1">Сеть</span><i class="fa-solid fa-globe ms-2"></i></a></li>
      <li class="nav-item"><a class="nav-link" href="#"><span class="flex-grow-1">Настройки</span><i class="fa-solid fa-cogs ms-2"></i></a></li>
      <li class="nav-item"><a class="nav-link" href="#"><span class="flex-grow-1">Сервис</span><i class="fa-solid fa-cog ms-2"></i></a></li>
      <li class="nav-item"><a class="nav-link" href="#"><span class="flex-grow-1">Помощь</span><i class="fa-solid fa-question-circle ms-2"></i></a></li>
    </ul>

    <div class="sidebar-logo-bottom">
      <img src="{% static 'main/images/su-logo-text.png' %}" alt="Secondary Logo" class="img-fluid" />
    </div>
  </nav>

  <!-- Контент: БЕЗ .row/.col вокруг, и БЕЗ col-12 -->
  <main class="with-sidebar px-3 px-md-4" style="min-height: 100%;">
    <div class="container-fluid">
      {% block main %}{% endblock %}
    </div>
  </main>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-geo@4.1.0/build/index.umd.min.js"></script>
  <script src="{% static 'main/scripts/script.js' %}"></script>
  {% block include_scripts %}{% endblock %}
</body>
</html>
