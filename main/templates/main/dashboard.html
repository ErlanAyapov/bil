{% extends "main.html" %}
{% load static %}
{% block title %}Мониторинг устройств{% endblock %}

{% block main %}
<div class="row g-2 align-items-stretch">
  <div class="col-md-6 d-flex flex-column gap-2">
    <div class="sm-container canvas-container p-3 flex-fill">
      <h5 class="text-muted">Распределение по типам</h5>
      <canvas class="canvas" id="traffic-chart"></canvas>
    </div>
    <div class="sm-container canvas-container p-3 flex-fill">
      <h5 class="text-muted">Распределение по регионам</h5>
      <canvas class="canvas" id="traffic-by-region" width="150" height="150"></canvas>
    </div>
  </div>
  <div class="col-md-6 d-flex align-items-center">
    <div class="sm-container canvas-container p-3 w-100">
      <h5 class="text-muted text-center">Типы трафика</h5>
      <canvas class="canvas" id="traffic-by-radar"></canvas>
    </div>
  </div>
</div>

<div class="sm-container p-1">
  <h5 class="text-muted">Глобальная активность</h5>
  <div id="active-users-card" class="row">
    <div class="col w-100">
      <canvas id="active-users-map" height="800"></canvas>
    </div>
    <div class="col-3">
      <table id="active-users-table" class="w-60">
        <thead>
          <tr><th class="w-30"> </th><th class="text-end">В сети</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<div class="mb-5">
  <div class="row g-1">
    <div class="col-md">
      <div class="sm-container p-3">
        <div class="table-responsive logs-container">
          <table class="table">
            <thead>
              <tr>
                <th>ID</th><th>Статус</th><th>Шлюзь</th><th>Страна</th><th>Геопозиция</th>
                <th>Оператор</th><th>Тип</th><th>Часовой пояс</th><th>Трафик</th><th>Точность</th>
              </tr>
            </thead>
            <tbody id="device-table-body">
              {% for device in devices %}
              <tr id="device-row-{{device.id}}" class="device-tr" onclick="selectDevice('device-row-{{device.id}}')" data-device-id="{{device.id}}">
                <td class="text-muted">{{device.id}}</td>
                <td>-</td>
                <td>{{device}}</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="sm-container p-3">
        <div class="col logs-container">
          <code class="logs"></code>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block include_scripts %}
  <script src="{% static 'main/scripts/dashboard.js' %}"></script>
  <script src="{% static 'main/scripts/device.js' %}"></script>
{% endblock %}
